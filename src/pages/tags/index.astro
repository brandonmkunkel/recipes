---
import { getCollection } from 'astro:content'

import Layout from '~/layouts/Layout.astro'
import Header from '~/components/Header.astro'
import SearchBar from '~/components/SearchBar.astro'

const recipes = await getCollection('recipes')
const tags = new Set()
for (const r of recipes) {
  for (const t of r.data.tags ?? []) tags.add(t)
}
const tagsArr = Array.from(tags).sort((a, b) => a.localeCompare(b))
---

<Layout title="Tags">
  <Header />
  <SearchBar />

  <main>
    <h1>Tags</h1>
    {
      tagsArr.length === 0 ? (
        <p>No tags found.</p>
      ) : (
        <ul class="tags-grid">
          {tagsArr.map((t) => (
            <li>
              <a href={`/recipes/tags/${t}/`} class="tag-chip">
                {t}
              </a>
            </li>
          ))}
        </ul>
      )
    }
  </main>
</Layout>

<style>
  main {
    max-width: 800px;
    margin: 0 auto;
    padding: 1rem;
  }

  .tags-grid {
    list-style: none;
    padding: 0;
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .tag-chip {
    display: inline-block;
    background: #efefef;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    text-decoration: none;
    color: inherit;
  }
</style>
